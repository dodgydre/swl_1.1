!function($){"use strict";function imgResize(e,t,i,r,a,s,o,n){var l,h,d,c,g,p,w,f,m=new Array(4);if(l=parseFloat(e.data("r")),c=(t-a)/(i-s),h=e.data("f"),200===h?(h=1,d=!1):(h=parseFloat(h/100),d=!0),l||(l=e.width()/e.height()),h||(h=1),d?(c>l?(g=(i-s)*h,p=g*l):(p=(t-a)*h,g=p/l),w=(i-s-g)/2,f=(t-a-p)/2):l<1?(p=t,g=p/l,g<i?(g=i,p=g*l,f=(t-p)/2-o,w=(i-g)/2-n):(w=(i-g)/2-n,f=(t-p)/2-o)):(g=i,p=g*l,p<t&&(p=t,g=p/l),f=(t-p)/2-o,w=(i-g)/2-n),e.hasClass("full")&&(c>l?(p=t,g=p/l,f=0,w=-(p-t)/2):(g=i,p=g*l,f=-(g-i)/2,w=0)),"margin"===r)e.width(p).height(g).css({marginTop:w+"px",marginLeft:f+"px"});else if("position"===r)e.width(p).height(g).css({top:w+"px",left:f+"px"});else if("array"===r)return m[0]=p,m[1]=g,m[2]=f,m[3]=w,m}function imgResizeLeft(e,t,i,r,a,s,o,n){var l,h,d,c,g,p,w,f,m=new Array(4);l=parseFloat(e.data("r")),c=(t-a)/(i-s),h=e.data("f"),200===h?(h=1,d=!1):(h=parseFloat(h/100),d=!0),l||(l=e.width()/e.height()),h||(h=1),d?(c>l?(g=(i-s)*h,p=g*l):(p=(t-a)*h,g=p/l),w=(i-s-g)/2,f=(t-a-p)/2):l<1?(p=t,g=p/l,g<i?(g=i,p=g*l,f=(t-p)/2-o,w=(i-g)/2-n):(w=(i-g)/2-n,f=(t-p)/2-o)):(g=i,p=g*l,p<t&&(p=t,g=p/l),f=(t-p)/2-o,w=(i-g)/2-n),e.hasClass("full")&&(c>l?(p=t,g=p/l,f=0,w=-(p-t)/2):(g=i,p=g*l,f=0,w=0));var f=o;if("margin"===r)e.width(p).height(g).css({marginTop:w+"px",marginLeft:f+"px"});else if("position"===r)e.width(p).height(g).css({top:w+"px",left:f+"px"});else if("array"===r)return m[0]=p,m[1]=g,m[2]=f,m[3]=w,m}function resizeSite(){var e,t,i,r;ww=$(window).width(),wh=$(window).height(),headerheight=$("body").hasClass("mobile")?45:105,iah=wh-headerheight-footerheight,siteratio=ww/iah,ww<minww&&(ww=minww),wh<minwh&&(wh=minwh),$("#site, .scrollwrap, .site").width(ww).height(iah),$("body").hasClass("mobile")?($(".arrw").hide(),$("#proj_img img").each(function(){$(this).removeClass("slide").addClass("single_project_image"),$(this).css("width",ww+"px").css("height","").css("display","")}),$(".proj.active img").each(function(){$(this).css("display","block").show()}),$(".proj_wrapper").each(function(){$(this).css("width",ww+"px").height($(window).height()-90)})):$("body").hasClass("large")&&$("#proj_img img").each(function(){$(this).removeClass("single_project_image").addClass("slide")}),$("#proj_img .slide").each(function(){var r,a,s,o,n,l,h=$(this);if(e=parseFloat(h.data("r")),t=h.data("f"),200===t?(t=1,i=!1):(t=parseFloat(t/100),i=!0),$(this).hasClass("full"))r=ww,a=iah,s=ww/iah,o=e,s<o?(n=iah*o,$(this).css("width",n).css("height",iah).css("top","0").css("left",-(iah*o-ww)/2)):(l=ww/o,$(this).css("width",ww).css("height",l).css("top",-(ww/o-iah)/2).css("left","0"));else if(centered){imgResize(h,ww,iah,"position",0,0,0,0)}else{imgResizeLeft(h,ww,iah,"position",135,0,105,0)}}),r=$(".slideshow .slide:visible"),r.length>0&&r.hasClass("video")?$(".arrw.down").length>0?($(".arrw.left, .arrw.right").height(iah/2).width(ww/2),$(".arrw.down").hide()):$(".arrw.left, .arrw.right").height(iah/1.5).width(ww/2):($(".arrw.left, .arrw.right").height(iah-iah/4).width(ww/2),$(".arrw.down").show())}function adjustFooterHeight(){var e,t,i,r;e=$(window).height()-footerheight-headerheight,t=$(".single-footer__container").height(),i=$(".single-below-footer__container").outerHeight(),i<33&&(i=0),i>e-150&&(i=e-150,r=i-40,$(".single-below-footer__description").height(r).css("overflow-y","scroll"),$(".single-below-footer__container")),$(".single-footer__container").stop().animate({height:i+footerheight},{duration:200,easing:"jswing"}),$(".single-below-footer__container").stop().animate({marginTop:-i},{duration:200,easing:"jswing"}),$(".single-below-footer__container").height(i)}function getNewProject(e,t,i,r){var a=i.data("id");$.ajax({url:ajaxgetprojectimgs.ajaxurl,type:"post",data:{action:"ajax_get_project_imgs",project_id:a},dataType:"json",success:function(e){$.each(e,function(e,t){i.find(".proj_wrapper").first().append(t)}),resizeSite()}})}function loadPrevAndNextProject(e){var t,i;t=e.next(".proj").first().length>0?e.nextAll(".proj").first():$(".proj:first-child"),""===t.find(".proj_wrapper").first().html()&&getNewProject(e,"",t,""),i=e.prevAll(".proj").first().length>0?e.prevAll(".proj").first():$(".proj").eq($("proj").length-1),""===i.find(".proj_wrapper").first().html()&&getNewProject(e,"",i,"")}function getPrevAndNextButtons(e){var t,i,r,a,s,o;r=e.parent().data("t"),"projects"===r&&(a="project"),t=e.next(".proj").first().length>0?e.nextAll(".proj").first():$(".proj:first-child"),i=e.prevAll(".proj").first().length>0?e.prevAll(".proj").first():$(".proj").eq($("proj").length-1),s=siteUrl+"/"+a+"/"+t.attr("id").replace("p_",""),o=siteUrl+"/"+a+"/"+i.attr("id").replace("p_",""),$(".arrw.down").attr("href",s).attr("data-id",t.data("id")),$(".arrw.up").attr("href",o).attr("data-id",i.data("id"))}function slideToProject(e,t,i,r){var a,s,o,n,l,h,d,c,g;g=$(window).width(),$("body").hasClass("large")?(a=t.offset().left,s=i.find(".slide:first-child"),n=imgResize(s,g,iah,"array",0,0,0,0),o=t.offset().top,$(".single-footer__container").hasClass("expanded")&&$(".single-expand").click(),"u"===r?(t.stop().animate({top:o+wh+gutter},{duration:speed-100,easing:easing}).hide().css("top",o+"px"),s.css("top",n[3]-wh-gutter+"px").show(0).stop().animate({top:n[3]},{duration:speed,easing:easing}),l=13*($(".proj.active .slide").length-1)):(t.stop().animate({top:o-wh},{duration:speed-100,easing:easing}).hide(0).css("top",o+"px"),s.css("top",g+n[3]+"px").show(0).stop().animate({top:n[3]},{duration:speed,easing:easing}))):(s=i,$(".single-footer__container").hasClass("expanded")&&$(".single-expand").click(),"u"===r?(t.stop().animate({left:g},{duration:50,easing:easing,complete:function(){$(this).hide().css("left","0")}}),s.css("left","-"+g+"px").show(0).stop().animate({left:0},{duration:300,easing:easing})):(t.stop().animate({left:-g},{duration:50,easing:easing,complete:function(){$(this).hide(0).css("left","0px")}}),s.css("left",g+"px").show(0).stop().animate({left:0},{duration:300,easing:easing}))),e.removeClass("active"),e.find(".single-project-caption").addClass("inactive"),e.find(".single-project-description").addClass("inactive"),e.find(".single-project-date").addClass("inactive"),i.addClass("active"),i.find(".single-project-caption").removeClass("inactive"),i.find(".single-project-description").removeClass("inactive"),i.find(".single-project-date").removeClass("inactive"),h=$("#proj_img .active img").first().nextAll(".single-project-caption").first().html(),d=$("#proj_img .active img").first().nextAll(".single-project-description").first().html(),c=$("#proj_img .active img").first().nextAll(".single-project-date").first().html(),$(".single-footer__caption").html(h),$(".single-footer__caption-date").html(c),$(".single-below-footer__description").html(d),getPrevAndNextButtons(i),document.title=i.data("title")+"- Structure Workshop",loadPrevAndNextProject(i)}function goToProject(e,t){var i,r,a,s,o;r=$("#proj_img"),a=$(".proj.active"),o=$($("body").hasClass("large")?".proj.active .slide:visible":".proj.active"),s=$("#p_"+t),i=s.index()>a.index()?0===a.index()&&s.index()===$(".proj").length-1?"u":"d":a.index()===$(".proj").length-1&&0===s.index()?"d":"u",""===s.find(".proj_wrapper").first().html()?(getNewProject(a,o,s,i),slideToProject(a,o,s,i)):slideToProject(a,o,s,i)}function getPage(e,t){var i,r;"/"!==e[0]&&(e="/"+e),"/"!==currenturl[0]&&(currenturl="/"+currenturl),i=e.split("/"),r=currenturl.split("/"),e!==currenturl&&("project"===i[2]?goToProject(e,i[3]):"project"===i[1]&&goToProject(e,i[2]),currenturl=e)}function swipeProjectLeft(e,t,i,r,a){var s;e.preventDefault(),s=$(".arrw.down").attr("href"),History.pushState(null,null,s)}function swipeProjectRight(e,t,i,r,a){var s;e.preventDefault(),s=$(".arrw.up").attr("href"),History.pushState(null,null,s)}function setLargeWindowClasses(){headerheight=105,iah=wh-footerheight-headerheight,$("body").addClass("large").removeClass("mobile"),$("#proj_img").addClass("large").removeClass("mobile"),$("#proj_img_container").addClass("large").removeClass("mobile"),$("#proj_img_container").height(iah),$("#proj_img img").addClass("slide")}function setMobileClasses(){headerheight=45,iah=wh-footerheight-headerheight,$("body").removeClass("large").addClass("mobile"),$("#proj_img").removeClass("large").addClass("mobile"),$("#proj_img_container").removeClass("large").addClass("mobile"),$("#proj_img_container").height(iah),$("#proj_img img").removeClass("slide"),$(".single-footer__more").text(" / Read text"),$(".arrw").hide()}var ww=$(window).width(),wh=$(window).height(),headerheight=105,footerheight=45,iah=wh-headerheight-footerheight,siteratio=ww/iah,minww=0,minwh=0,gutter=0,easing="jswing",speed=400,fadeOutSpeed=300,fadeInSpeed=700,currenturl=window.location.pathname,centered=!1;$(document).ready(function(){var History,hash,caption,description,imagedate,State,url,href;$(window).width()>769?setLargeWindowClasses():setMobileClasses(),resizeSite(),$(".single-expand").click(function(e){e.preventDefault(),$(".single-footer__container").hasClass("expanded")?($(".single-footer__container").stop().animate({height:footerheight},{duration:20,easing:"jswing"}),$(".single-below-footer__container").stop().animate({marginTop:0},{duration:20,easing:"jswing"}),$(".single-footer__container").removeClass("expanded"),$("body").hasClass("large")?$(".single-footer__more").text(" / Read text"):$(".single-footer__more").text(" / Read text")):(adjustFooterHeight(),$(".single-footer__container").addClass("expanded"),$("body").hasClass("large")?$(".single-footer__more").text(" / Hide text"):$(".single-footer__more").text(" / Hide text"))}),History=window.History,History.enabled&&(History.Adapter.bind(window,"statechange",function(){State=History.getState(),url=document.createElement("a"),url.href=State.url,getPage(url.pathname,!1)}),hash=window.location.hash,hash&&History.Adapter.trigger(window,"statechange")),$.browser.msie||$("#proj_img").length>0&&($("body").hasClass("large")&&$("#proj_img").length>0&&($("#proj_img img").hide(),$("#proj_img .active img").first().fadeIn(400)),caption=$("#proj_img .active img").first().nextAll(".single-project-caption").html(),description=$("#proj_img .active img").first().nextAll(".single-project-description").html(),imagedate=$("#proj_img .active img").first().nextAll(".single-project-date").html(),$(".single-footer__caption").html(caption),$(".single-footer__caption-date").html(imagedate),$(".single-below-footer__description").html(description)),$(window).resize(function(){$(window).width()>769?$(".mobile").length>0&&(headerheight=105,iah=$(window).height()-headerheight-footerheight,$("body").addClass("large").removeClass("mobile"),$("#proj_img").addClass("large").removeClass("mobile"),$("#proj_img_container").addClass("large").removeClass("mobile"),$("#proj_img img").hide(),$("#proj_img .active img").first().fadeIn(400),caption=$("#proj_img .active img").first().nextAll(".single-project-caption").first().html(),description=$("#proj_img .active img").first().nextAll(".single-project-description").first().html(),imagedate=$("#proj_img .active img").first().nextAll(".single-project-date").first().html(),$(".single-footer__caption").html(caption),$(".single-footer__caption-date").html(imagedate),$(".single-below-footer__description").html(description),$(".arrw").show(),$(document).keydown(function(e){37!==e.which||e.metaKey?38!==e.which||e.metaKey?39!==e.which||e.metaKey?40!==e.which||e.metaKey||(e.preventDefault(),$(".arrw.down").click()):(e.preventDefault(),$(".arrw.right").click()):(e.preventDefault(),$(".arrw.up").click()):(e.preventDefault(),$(".arrw.left").click())}),$(".arrw").swipe({swipe:function(e,t,i,r,a,s){"left"===t&&$(".arrw.right").click(),"right"===t&&$(".arrw.left").click(),"down"===t&&$(".arrw.up").click(),"up"===t&&$(".arrw.down").click()}}),$(".proj").unbind("swipe")):$(".large").length>0&&(headerheight=45,iah=$(window).height()-headerheight-footerheight,$("body").removeClass("large").addClass("mobile"),$("#proj_img").removeClass("large").addClass("mobile"),$("#proj_img_container").removeClass("large").addClass("mobile"),$("#proj_img_container").height(iah),$(".arrw").hide(),$(".proj").swipe({swipeLeft:swipeProjectLeft,swipeRight:swipeProjectRight,allowPageScroll:"vertical"}),$(".arrw").unbind("swipe")),resizeSite()}),$("#proj_img.project .arrw").click(function(){var dir,thislink,thisSlideShow,slideToShow,thisProject,current,imgDim,currentLeft,nextCurrentLeft,nextNextLeft,caption,imagedate,description,cw,ch,captionText,pause_string;if(ww=$(window).width(),wh=$(window).height(),cw=ww,ch=wh-footerheight-headerheight,thislink=$(this),$(this).hasClass("left")?dir="l":$(this).hasClass("right")?dir="r":$(this).hasClass("up")?dir="u":$(this).hasClass("down")&&(dir="d"),resizeSite(),thisSlideShow=$("#proj_img"),thisProject=$(".proj.active"),current=$(".proj.active .slide:visible"),current.hasClass("video")&&(pause_string="player_"+thisProject.attr("data-id")+".pause()",eval(pause_string)),"l"===dir){if(thisProject.find(".slide").length>1){if(slideToShow=current.prevAll(".proj.active .slide").first().length>0?current.prevAll(".proj.active .slide").first():$(".proj.active .slide").eq($(".proj.active .slide").length-1),$(".single-footer__container").hasClass("expanded")&&$(".single-expand").click(),thisSlideShow.hasClass("fading"))current.fadeOut(fadeOutSpeed),slideToShow.fadeIn(fadeInSpeed);else if(thisSlideShow.hasClass("sliding")){if(centered)var imgDim=imgResize(slideToShow,ww,iah,"array",0,0,0,0);else var imgDim=imgResizeLeft(slideToShow,ww,iah,"array",135,0,105,0);currentLeft=current.offset().left,nextCurrentLeft=currentLeft+cw+gutter,nextNextLeft=imgDim[2]-cw-gutter,current.stop().animate({left:nextCurrentLeft},{duration:speed,easing:easing}).hide(0).css("left",currentLeft+"px"),slideToShow.css("left",nextNextLeft+"px").show(0).stop().animate({left:imgDim[2]},{duration:speed,easing:easing})}captionText=slideToShow.next("span").html(),$("footer .imgcap").html(captionText),slideToShow.hasClass("video")?($(".arrw.left, .arrw.right").height(ch/2),$(".arrw.down").hide()):($("arrw.left, .arrw.right").height(ch-120),$("arrw.down").show())}}else if("r"===dir){if(thisProject.find(".slide").length>1){if(slideToShow=current.nextAll(".proj.active .slide").first().length>0?current.nextAll(".proj.active .slide").first():$(".proj.active .slide:first-child"),$(".single-footer__container").hasClass("expanded")&&$(".single-expand").click(),thisSlideShow.hasClass("fading"))current.fadeOut(fadeOutSpeed),slideToShow.fadeIn(fadeInSpeed);else if(thisSlideShow.hasClass("sliding")){if(centered)var imgDim=imgResize(slideToShow,ww,iah,"array",0,0,0,0);else var imgDim=imgResizeLeft(slideToShow,ww,iah,"array",135,0,105,0);currentLeft=current.offset().left,nextCurrentLeft=-(ww+gutter),nextNextLeft=imgDim[2]+ww+gutter,current.stop().animate({left:nextCurrentLeft},{duration:speed,easing:easing}).hide(0).css("left",currentLeft+"px"),slideToShow.css("left",nextNextLeft+"px").show(0).stop().animate({left:imgDim[2]},{duration:speed,easing:easing})}captionText=slideToShow.next("span").html(),$("#footer .imgcap").html(captionText),slideToShow.hasClass("video")?($(".arrw.left, .arrw.right").height(ch/2),$(".arrw.down").hide()):($(".arrw.left, .arrw.right").height(ch-120),$(".arrw.down").show())}}else"u"!==dir&&"d"!==dir||(href=thislink.attr("href"),History.pushState(null,null,href));return!1}),$("body").hasClass("large")?($(document).keydown(function(e){37!==e.which||e.metaKey?38!==e.which||e.metaKey?39!==e.which||e.metaKey?40!==e.which||e.metaKey||(e.preventDefault(),$(".arrw.down").click()):(e.preventDefault(),$(".arrw.right").click()):(e.preventDefault(),$(".arrw.up").click()):(e.preventDefault(),$(".arrw.left").click())}),$(".arrw").swipe({swipe:function(e,t,i,r,a,s){"left"===t&&$(".arrw.right").click(),"right"===t&&$(".arrw.left").click(),"down"===t&&$(".arrw.up").click(),"up"===t&&$(".arrw.down").click()}})):$(".proj").swipe({swipeLeft:swipeProjectLeft,swipeRight:swipeProjectRight,allowPageScroll:"vertical"}),getPrevAndNextButtons($(".proj.active")),loadPrevAndNextProject($(".proj.active"))})}(jQuery);